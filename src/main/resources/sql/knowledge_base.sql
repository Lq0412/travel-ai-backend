-- ====================================
-- 从化旅游知识库数据库脚本
-- ====================================

-- 创建景点知识库表
CREATE TABLE IF NOT EXISTS `tb_knowledge_attraction` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    `name` VARCHAR(100) NOT NULL COMMENT '景点名称',
    `description` TEXT COMMENT '景点描述',
    `category` VARCHAR(50) COMMENT '类型：自然/文化/温泉/美食/休闲',
    `season` VARCHAR(50) COMMENT '最佳季节：春/夏/秋/冬/全年',
    `suitable_for` VARCHAR(100) COMMENT '适合人群：家庭/情侣/老人/儿童/年轻人',
    `price_level` INT COMMENT '价格等级：1-5（1=经济，5=豪华）',
    `rating` DECIMAL(3,1) COMMENT '评分（0-5.0）',
    `tags` JSON COMMENT '标签',
    `address` VARCHAR(200) COMMENT '地址',
    `opening_hours` VARCHAR(100) COMMENT '营业时间',
    `ticket_price` VARCHAR(50) COMMENT '门票价格',
    `features` JSON COMMENT '特色亮点',
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `is_deleted` TINYINT DEFAULT 0 COMMENT '是否删除（0-未删除，1-已删除）',
    INDEX `idx_category` (`category`),
    INDEX `idx_season` (`season`),
    INDEX `idx_rating` (`rating`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='景点知识库';

-- 创建美食知识库表
CREATE TABLE IF NOT EXISTS `tb_knowledge_food` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    `name` VARCHAR(100) NOT NULL COMMENT '美食名称',
    `description` TEXT COMMENT '美食描述',
    `category` VARCHAR(50) COMMENT '类型：主食/小吃/特产/饮品',
    `taste` VARCHAR(50) COMMENT '口味：甜/咸/辣/酸/鲜',
    `price_range` VARCHAR(50) COMMENT '价格区间',
    `where_to_eat` TEXT COMMENT '推荐餐厅',
    `season` VARCHAR(50) COMMENT '最佳季节',
    `tags` JSON COMMENT '标签',
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `is_deleted` TINYINT DEFAULT 0 COMMENT '是否删除'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='美食知识库';

-- ====================================
-- 导入景点数据（从原有硬编码迁移）
-- ====================================

INSERT INTO `tb_knowledge_attraction` 
(`name`, `description`, `category`, `season`, `suitable_for`, `price_level`, `rating`, `tags`, `address`, `opening_hours`, `ticket_price`, `features`) 
VALUES
-- 石门国家森林公园
('石门国家森林公园', 
 '以森林景观为主，四季景色各异，尤其以秋日红叶著称', 
 '自然', 
 '全年', 
 '家庭,情侣,老人,摄影爱好者', 
 2, 
 4.7, 
 '["森林","红叶","徒步","摄影"]',
 '广州市从化区温泉镇',
 '08:00-18:00',
 '40元',
 '["秋季红叶景观","千年古树","天池瀑布","溪流景观"]'),

-- 流溪河国家森林公园
('流溪河国家森林公园', 
 '湖光山色，岛屿众多，适合游船和徒步', 
 '自然', 
 '全年', 
 '家庭,情侣,徒步爱好者', 
 2, 
 4.6, 
 '["湖泊","游船","徒步","露营"]',
 '广州市从化区良口镇',
 '08:30-17:30',
 '30元',
 '["22个岛屿","流溪香雪","五指山","猴岛"]'),

-- 碧水湾温泉度假村
('碧水湾温泉度假村', 
 '五星级温泉度假村，拥有多种温泉池和SPA服务', 
 '温泉', 
 '冬季', 
 '家庭,情侣,商务人士', 
 4, 
 4.8, 
 '["温泉","SPA","度假","五星级"]',
 '广州市从化区御泉大道',
 '全天24小时',
 '168元起',
 '["33个温泉池","苏打温泉","禅意SPA","星级服务"]'),

-- 溪头村
('溪头村', 
 '被誉为"广州最美乡村"，适合体验农家乐和徒步', 
 '休闲', 
 '全年', 
 '家庭,情侣,徒步爱好者,摄影爱好者', 
 1, 
 4.5, 
 '["乡村","农家乐","徒步","摄影"]',
 '广州市从化区良口镇溪头村',
 '全天开放',
 '免费',
 '["竹海","古村落","农家菜","清新空气"]'),

-- 千泷沟大瀑布
('千泷沟大瀑布', 
 '壮观的大瀑布群，夏季避暑胜地', 
 '自然', 
 '夏季', 
 '家庭,年轻人,探险爱好者', 
 2, 
 4.4, 
 '["瀑布","避暑","负氧离子","探险"]',
 '广州市从化区良口镇',
 '08:00-17:00',
 '50元',
 '["九级瀑布","空气清新","峡谷景观","夏季清凉"]'),

-- 温泉旅游区
('温泉旅游区', 
 '多个温泉度假村集中区域', 
 '温泉', 
 '冬季', 
 '家庭,情侣,老人', 
 3, 
 4.5, 
 '["温泉","度假","养生","休闲"]',
 '广州市从化区温泉镇',
 '全天24小时',
 '不等',
 '["多家温泉酒店","苏打温泉","养生理疗","星级住宿"]'),

-- 北回归线标志塔
('北回归线标志塔', 
 '地理标志性建筑，科普教育点', 
 '文化', 
 '全年', 
 '家庭,儿童,学生', 
 1, 
 4.0, 
 '["科普","地理","教育","地标"]',
 '广州市从化区太平镇',
 '09:00-17:00',
 '免费',
 '["地理标志","科普展览","观景台","教育意义"]'),

-- 天湖旅游风景区
('天湖旅游风景区', 
 '湖光山色，适合休闲度假', 
 '自然', 
 '全年', 
 '家庭,情侣,休闲度假', 
 2, 
 4.3, 
 '["湖泊","山景","休闲","度假"]',
 '广州市从化区良口镇',
 '08:00-18:00',
 '35元',
 '["高山湖泊","云海景观","登山步道","度假酒店"]'),

-- 大岭山石门
('大岭山石门', 
 '奇特的地质景观', 
 '自然', 
 '全年', 
 '探险爱好者,摄影爱好者', 
 1, 
 4.2, 
 '["地质","奇景","探险","摄影"]',
 '广州市从化区温泉镇',
 '全天开放',
 '免费',
 '["石门奇观","地质构造","山景","原生态"]'),

-- 三桠塘幽谷
('三桠塘幽谷', 
 '原始森林溪谷，适合探险', 
 '自然', 
 '春季', 
 '年轻人,探险爱好者', 
 2, 
 4.3, 
 '["溪谷","探险","原始森林","瀑布"]',
 '广州市从化区良口镇',
 '08:00-17:00',
 '30元',
 '["原始森林","溪流瀑布","负氧离子","生态环境"]');

-- ====================================
-- 导入美食数据（从原有硬编码迁移）
-- ====================================

INSERT INTO `tb_knowledge_food` 
(`name`, `description`, `category`, `taste`, `price_range`, `where_to_eat`, `season`, `tags`) 
VALUES
('吕田焖大肉', 
 '肥而不腻的传统菜肴', 
 '主食', 
 '咸', 
 '50-80元/份', 
 '吕田镇各农家乐', 
 '全年', 
 '["传统","农家菜","特色"]'),

('泥焗走地鸡', 
 '用泥土包裹烤制的特色鸡', 
 '主食', 
 '鲜', 
 '100-150元/只', 
 '溪头村、温泉镇农家乐', 
 '全年', 
 '["特色","走地鸡","烤制"]'),

('桂峰酿豆腐', 
 '当地豆腐制作，口感独特', 
 '主食', 
 '鲜咸', 
 '30-50元/份', 
 '桂峰村、各镇餐馆', 
 '全年', 
 '["豆腐","传统","家常"]'),

('流溪大鱼头', 
 '流溪河水库的鲜鱼', 
 '主食', 
 '鲜', 
 '80-120元/份', 
 '流溪河畔餐馆', 
 '全年', 
 '["河鲜","特色","鱼头"]'),

('吕田芥菜', 
 '当地特产蔬菜', 
 '小吃', 
 '微辣', 
 '15-25元/份', 
 '吕田镇、良口镇餐馆', 
 '冬春', 
 '["蔬菜","特产","时令"]'),

('山坑螺', 
 '山涧中的螺类，味道鲜美', 
 '小吃', 
 '鲜辣', 
 '30-50元/份', 
 '各镇夜宵摊、餐馆', 
 '全年', 
 '["螺类","夜宵","鲜美"]'),

('竹筒饭', 
 '用竹筒烹制的米饭，带有竹香', 
 '主食', 
 '香', 
 '20-30元/份', 
 '溪头村、各景区', 
 '全年', 
 '["竹香","特色","米饭"]'),

('荔枝蜜', 
 '从化特产蜂蜜', 
 '特产', 
 '甜', 
 '80-150元/斤', 
 '各土特产店、农家', 
 '春夏', 
 '["蜂蜜","特产","伴手礼"]'),

('青梅酒', 
 '当地酿制的果酒', 
 '饮品', 
 '酸甜', 
 '50-100元/瓶', 
 '各土特产店', 
 '全年', 
 '["果酒","特产","伴手礼"]');

-- ====================================
-- 完成提示
-- ====================================
SELECT '✅ 知识库数据迁移完成！' AS status,
       (SELECT COUNT(*) FROM tb_knowledge_attraction) AS attraction_count,
       (SELECT COUNT(*) FROM tb_knowledge_food) AS food_count;

